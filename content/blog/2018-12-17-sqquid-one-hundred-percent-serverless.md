---
title: "SQQUID：100% 无服务器初创公司"
description: "SQQUID 将 AWS Lambda 和无服务器框架用于其核心产品和营销网站。我们来看看一个完全无服务器的初创公司是怎样的。"
date: 2018-12-17
thumbnail: "https://s3-us-west-2.amazonaws.com/assets.blog.serverless.com/sqquid/sqquid-serverless-thumb.jpg"
heroImage: "https://s3-us-west-2.amazonaws.com/assets.blog.serverless.com/sqquid/sqquid-serverless-header.jpeg"
category:
  - user-stories
authors: 
  - RonPeled
---

我叫 Ron Peled，是 [SQQUID](https://sqquid.com/) 的 CEO 兼创始人。SQQUID 是一个为零售商实现销售规划和订单履行自动化的平台。我们帮助中小型零售商实现网上订单处理和实体店发货的自动化，从而降低他们的成本，使他们能够与 Walmart 和 Amazon Prime 等大型公司竞争。

这是我们切实坚持的使命，它为我们开辟了一条道路：颠覆一个拥有大量老旧支持基础结构的巨大产业。开辟新领域的唯一方法就是迅速行动，精益求精。

在创办公司之时，我和首席技术官 (CTO) 非常看好无服务器。我们是 AWS Lambda 和无服务器框架的早期先行者。从一开始，SQQUID 就是一个几乎 100% 无服务器的商店。这是我们做过的最明智的一个决定。正因为如此，在 SQQUID 的技术堆栈环境上进行构建才会乐趣无穷、令人兴奋。

如果您想全面了解实现完全无服务器的意义，例如我们的架构提供给我们什么、我们构建了哪些新的设计模式以及这种环境如何让我们的小团队能够更快地更新迭代，那就请继续往下读吧！

#### 实现无服务器之前：Docker

SQQUID 并非我的第一家公司。我曾是 Educents（一家由 YC 提供支持的教育初创公司）的 CTO 兼联合创始人。

在 Educents，我们依赖于 Docker。它具有超强的可扩展性，但是作为 CTO，从预算的角度来看，它简直是一场噩梦。那时，AWS 尚不支持 Kubernetes，因此我们的基础结构成本很高，我们需要持续维护以确保一切平稳运行。

因此在我成立下一家初创公司时，我就明白当务之急是找到一种方法，可以摆脱完全托管的 Docker 环境。

#### 无服务器的前进之路

当我创办 SQQUID 时，FaaS 系统刚刚开始普及。在阅读了几个月关于无服务器的内容之后，我们决定全部使用 AWS Lambda，一个更大的 AWS 生态系统和[无服务器框架](https://serverless.com/framework/)。

这个决定有点冒险，但最终结果表明这是一个极好的决定。因为我们没有服务器，所以我们快速、敏捷。我们可以通过相对较小的团队持续推出强大的功能。

我们有如此强大的力量触手可及，令人难以置信。

##### 串行调控器：功能架构

在 SQQUID，我们的一项主要工作是管理跨平台和跨客户的大量集成。

正如任何使用大量外部 API 的企业所理解的那样，处理集成差异（如节流或错误管理）可能会因 API 的不同（如 Magento、BigCommerce 或 Shopify）而大有不同。除此之外，在每个特定的集成中，从特定的节流限制到自定义字段管理，各个账户的挑战都各有不同。

为了管理所有这些问题，我们开发了一种设计模式，称为“串行调控器”。串行调控器负责监视每个集成（例如，产品和订单导入）的一组并行 Lambda 执行，但在不同的客户之间独立运行。

在函数执行期间，系统需要管理每个账户（不仅仅是每个函数）的并行执行数量，并在客户级别和整体集成级别处理 API 限制和错误。这一点很重要，因为我们的系统全天 24 小时连接到多个账户的多个渠道。

实现错误管理是成功的关键。串行调控器的错误管理系统和失能开关可帮助我们管理特定账户和整体集成产生的问题。

<img src="https://s3-us-west-2.amazonaws.com/assets.blog.serverless.com/sqquid/sqquid-serial-governor.png" alt="SQQUID serial governor">

当集成出现系统范围的问题或某个特定客户的账户被拒绝时，会发生什么情况呢？通过 Lambda，可以轻松地反复访问服务器，但这对于有效应对这种情况用处不大。某个特定的服务器可能存在负载或网络问题。正因如此，我们的系统包含自动回退客户集成的逻辑。

遇到的错误越多，等待再次尝试 API 的时间就越长。成功建立连接后，我们会尽快恢复速度。

##### 我们从这个新的架构收获了什么？

无服务器环境、串行调控器设计模式以及错误处理算法的组合使用，可为我们提供极大的灵活性和强大的功能。我们现在能够最大限度地提高每个集成和每个客户账户的吞吐量，而在旧 DevOps 范式中，这对于一家初创公司来说太过耗费资源，难以实现。

这种架构让我们有更多的时间专注于新功能和业务逻辑，因为我们的系统很少停机。由于我们拥有一定程度的自动修复功能，所以当一个 API 未按预期响应或出现故障时，我们几乎无需执行任何操作。

在许多情况下，客户可以依靠我们来了解他们的其他系统中有哪些不可用以及不可用持续的时间。

#### 我们在这个过程中学到了什么：无服务器学习曲线

坦白来说，无服务器（即 FaaS 基础结构）学习曲线可能很陡峭，尤其是当您习惯于单片式架构时。也就是说，无服务器的优点远远大于缺点。

因此，对于任何新项目，我和我的团队只推荐使用 FaaS 架构。

如果您考虑实现无服务器，您需要提前了解以下信息。

##### 考虑使用 FaaS，而非单片式架构

由于 FaaS 和无服务器架构的性质，您应该从这种新范式的角度进行思考。不要试图调整旧技术或范式而使其适用。

一旦您理解了这样做的意义，开发就可以更快地进行，您就能逐渐感受到使用基于函数的架构有何好处。

##### 保护您的下游系统

Lambda 的特点是自动缩放。大多数 API 都没有这个特点。当我们因过度访问而意外地使另一家公司的 API（拥有大量数据中心基础结构）瘫痪时，我们才意识到了这一点。

Lambda 错误将立即自动启动一系列重试。因此，一不小心就会从错误发生处产生巨大影响。从好的方面来说，这个“事故”的 Lambda 成本只是 2 美元。

最后，作为一名前 CTO，从代码的第一行就知道产品具有可扩展性，这一变化可导致思维转变。之后的挑战就变成了如何与这些外部系统进行对接，而所有这些系统都有不同的节流和要求。

##### 可观察性不是很好，但正在改进

我们最终还是构建了自己的自定义错误处理和警报工具，因为现有的工具不符合我们的业务需求。即便如此，在过去的一年里，我们已经看到了 Cloudwatch 的改进，我们期待它会变得更好。

#### 总结：是否选择无服务器

在 SQQUID，向零售商提供顶级渠道管理、销售规划工具和订单履行自动化是我们引以为傲的资本。选择无服务器作为我们的架构使我们能够最好地为客户服务。

与我之前的创业公司相比，我们在明显更短的时间内推出大规模的强大功能，并且只需十分之一的人力，以及极低的基础结构成本。作为初创公司，这是一个至关重要的优势。

我们对选择无服务器这一决定万分满意。

祝您顺利实现无服务器。如有任何疑问，请随时留言！
